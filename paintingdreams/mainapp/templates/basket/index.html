{% extends "mainapp_base.html" %}

{% block content %}
<h1>Shopping Basket</h1>
<table class="table basket">
    <thead>
        <tr>
            <th colspan="2">Product</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Product total</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
{% for item in cart.items %}
        <tr>
            <td>
              {% with webimage=item.product.webimages.first %}
                <img src="/media/images/thumbnail/{{ webimage.filename }}" alt="{{ webimage.name }}" />
              {% endwith %}
            </td>
            <td>{{ item.product.displayname }}</td>
            <td>&pound;{{ item.product.product_type.price_final }}</td>
            <td>
                <form action="/basket-change-quantity" method="POST" class="form-inline">
                    {% csrf_token %}
                    <input type="hidden" name="product_id" value="{{ item.product.id }}" />
                    <input name="quantity" type="number" class="form-control" min="0" step="1" value="{{ item.quantity }}" />
                    <button type="submit" class="btn btn-default">Update</button>
                </form>
            </td>
            <td>&pound;{{ item.subtotal }}</td>
            <td>
                <form action="/basket-change-quantity" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="product_id" value="{{ item.product.id }}" />
                    <input type="hidden" name="quantity" value="0" />
                    <button type="submit" class="btn btn-default">Remove</button>
                </form>
            </td>
        </tr>
{% endfor %}
    </tbody>
</table>
<p class="basket-subtotal">Subtotal: &pound;{{ cart.total }}</p>
<p class="larger-text larger-bottom-margin">Postage price will be calculated based on the order weight and the shipping destination.</p>
<p><a href="/order-start" class="btn btn-primary btn-lg" role="button">Checkout</a></p>
{% endblock %}
